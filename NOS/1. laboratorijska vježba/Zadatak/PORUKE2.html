
<!-- saved from url=(0062)http://www.zemris.fer.hr/predmeti/os2/komunikacija/poruke.html -->
<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40"><script src="chrome-extension://ljdobmomdgdljniojadhoplhkpialdid/page/prompt.js"></script><script src="chrome-extension://ljdobmomdgdljniojadhoplhkpialdid/page/runScript.js"></script><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1250">

<meta name="ProgId" content="FrontPage.Editor.Document">
<meta name="Generator" content="Microsoft FrontPage 6.0">
<meta name="Originator" content="Microsoft Word 9">
<title>PORUKE2</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:Zoom>BestFit</w:Zoom>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<meta name="Template" content="D:\MSOFFICE\OFFICE\html.dot">
</head>

<body lang="EN-GB" link="blue" vlink="purple" style="tab-interval:36.0pt">

<div class="Section1">

<p align="center" style="text-align:center"><b><span style="font-size:18.0pt">KOMUNIKACIJA
PORUKAMA<o:p></o:p></span></b></p>

<p><b>REDOVI PORUKA<o:p></o:p></b></p>

<p>Poruka je mala kolièina podataka (na primjer, do nekoliko stotina bajtova)
koja može biti poslana u red poruka. Poruci se može pridijeliti tip po kojem se
može prepoznati. Svaki proces s odgovarajuæom dozvolom može primiti poruku iz
reda.</p>

<p>Red poruka može poslužiti kao semafor: stavljanje poruke u red je
ekvivalentno otvaranju semafora, a uzimanje poruke iz reda ekvivalentno je
zatvaranju semafora. Poziv za uzimanje poruke se normalno zablokira ako je red
prazan što odgovara stanju kada je semafor na nuli.</p>

<p><b>Sustavski pozivi za rad s redovima poruka<o:p></o:p></b></p>

<p>Rad sa redovima poruka je ovdje opisan nešto detaljnije nego što su bili
opisani pozivi za rad sa zajednièkom memorijom i skupovima semafora. Ipak, više
detalja se može naæi sa: <span style="font-family:&quot;Courier New&quot;">man msgget</span>,
<span style="font-family:&quot;Courier New&quot;">man msgop</span> i <span style="font-family:&quot;Courier New&quot;">man msgctl</span>. Podaci potrebni za rad sa
redovima poruka definirane su u datotekama <span style="font-family:&quot;Courier New&quot;">&lt;sys/types.h&gt;</span>,
<span style="font-family:&quot;Courier New&quot;">&lt;sys/ipc.h&gt;</span> i <span style="font-family:&quot;Courier New&quot;">&lt;sys/msg.h&gt;</span> koje treba ukljuèiti
na poèetku programa. Opis bitnih struktura podataka može se naæi sa <span style="font-family:&quot;Courier New&quot;">man intro</span>.</p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int msgget(key_t
key, int flags);<o:p></o:p></span></p>

<p>Sustavski poziv <i>msgget </i>stvara red poruka, ili vraæa identifikator
reda poruka ako red veæ postoji. Poziv je analogan sustavskom pozivu <i>open</i>.
Kao parametar prima kljuè <i>key</i> i vraæa identifikator reda, odnosno -1 ako
doðe do greške.</p>

<p>Identifikator reda je vrlo slièan opisniku datoteke, osim što ga može
koristiti bilo koji proces koji poznaje taj broj. Ako je postavljen bit <span style="font-family:&quot;Courier New&quot;">IPC_CREATE</span> u <i>flags</i>, red se
kreira ako veæ ne postoji, a devet najnižih bitova su dozvole za korištenje
reda. Dozvola za pisanje dopušta da poruka bude poslana, a dozvola za èitanje
dopušta primanje poruke. Ako <span style="font-family:&quot;Courier New&quot;">IPC_CREATE</span>
nije postavljen onda red mora postojati i u tom sluèaju ova funkcija samo
pronalazi identifikator reda. (Ako se za <i>key </i>stavi <span style="font-family:&quot;Courier New&quot;">IPC_PRIVATE</span> onda se kreira novi red
bez obzira na <span style="font-family:&quot;Courier New&quot;">IPC_CREAT</span>.)</p>

<p>Dozvole pristupa u <i>flags</i> su definirane na slijedeæi naèin:</p>

<p style="margin-left:36.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">00400Receive
message by user<br>
00200Send message by user<br>
00040Receive message by group<br>
00020Send message by group<br>
00004Receive message by others<br>
00002Send message by others<o:p></o:p></span></p>

<p style="margin-left:36.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">struct
msgbuf {<o:p></o:p></span></p>

<p style="margin-left:72.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">long
mtype;<br>
char mtext[1];<o:p></o:p></span></p>

<p style="margin-left:36.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">};<o:p></o:p></span></p>

<p style="margin-left:36.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int
msgsnd(int msqid, struct msgbuf *msgp, int msgsz, int msgflg);<o:p></o:p></span></p>

<p>Sustavski poziv <i>msgsnd</i> šalje poruku u red èiji je ID <i>msqid</i>
dobiven primjerice od <i>msgget</i>. <i>msgp </i>pokazuje na strukturu u kojoj
na prvom mjestu mora biti dugaèak cijeli broj veæi od nule - vrsta poruke.
Ostatak te strukture ovisi o podacima koji se šalju. Interno se ostatak poruke
prihvaæa kao niz znakova (bajtova) duljine <i>msgsz</i>. Tip poruke omoguæava
primaocu da odabere iz reda poruke koje želi izvaditi, odnosno može èekati
odreðeni tip poruke. <i>msgflg</i> je obièno 0, što uzrokuje da se <i>msgsnd</i>
zablokira dok je red pun. Druga moguænost je <span style="font-family:&quot;Courier New&quot;">IPC_NOWAIT</span>
što uzrokuje da poziv <i>msgsnd</i> vrati grešku ako je red pun. <i>msgsnd</i>
vraæa 0 ako uspije ili -1 ako doðe do greške.</p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int msgrcv(int
msqid, struct msgbuf *msgp, int msgsz, long msgtyp, int msgflg);<o:p></o:p></span></p>

<p>Sustavski poziv <i>msgrcv</i> poziva primalac poruke. <i>msgsz </i>mora biti
velièina najveæe poruke koja može stati u prostor na koji pokazuje <i>msgp.</i>
Obzirom da primljena poruka može biti manja od toga, ovaj poziv vraæa velièinu
poruke ili -1 ako doðe do greške. Ako primalac želi odreðenu vrstu poruke onda
je stavi u <i>msgtyp</i>. Inaèe se stavi 0 èime se uzima najstarija poruka iz
reda (bez obzira na vrstu poruke). Ako je red prazan ili u njemu nema poruka
tražene vrste onda æe se <i>msgrcv </i>zablokirati, osim ako je <i>msgflg</i> (<i>msgflg</i>
je obièno 0) <span style="font-family:&quot;Courier New&quot;">IPC_NOWAIT</span> u kojem
sluèaju æe se odmah vratiti -1 (greška).</p>

<p style="margin-left:36.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">struct
ipc_perm { <o:p></o:p></span></p>

<p style="margin-left:72.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">ushort
cuid;/*
<i>creator user id</i>*/<br>
ushort cgid;/* <i>creator group id</i>*/<br>
ushort uid;/* <i>user id</i>*/<br>
ushort gid;/*<i> group id</i>*/<br>
ushort mode;/*<i> r/w permission</i>*/<br>
ushort seq;/* <i>slot usage sequence #</i>*/<br>
key_t key;/* <i>key</i>*/<o:p></o:p></span></p>

<p style="margin-left:36.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">}
;<o:p></o:p></span></p>

<p style="margin-left:36.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">struct
msg { <o:p></o:p></span></p>

<p style="margin-left:72.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">struct
msg *msg_next;/*
<i>ptr to next message on queue</i> */<br>
long msg_type;/* <i>message type</i> */<br>
short msg_ts;/* <i>message text size</i> */<br>
short msg_spot;/* <i>message text map address</i> */<o:p></o:p></span></p>

<p style="margin-left:36.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">};<o:p></o:p></span></p>

<p style="margin-left:36.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">struct
msqid_ds { <o:p></o:p></span></p>

<p style="margin-left:72.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">struct
ipc_perm msg_perm;/*
<i>message operation permissions</i>*/<br>
struct msg *msg_first; /* <i>ptr to the first message on the queue</i>*/<br>
struct msg *msg_last; /* <i>ptr to the last message on the queue</i>*/<br>
ushort msg_cbytes; /* <i>current number of bytes on the queue</i>*/<br>
ushort msg_qnum; /* <i>nr of messages currently on the queue</i>*/<br>
ushort msg_qbytes; /* <i>max nr of bytes allowed on the queue</i>*/<br>
ushort msg_lspid; /* <i>last process that performed <b>msgsnd</b></i>*/<br>
ushort msg_lrpid; /* <i>last process that performed <b>msgrcv</b></i> */<br>
time_t msg_stime; /* <i>time of the last <b>msgsnd </b>operation</i>*/<br>
time_t msg_rtime; /* <i>time of the last <b>msgrcv </b>operation</i>*/<br>
time_t msg_ctime; /* <i>time of the last <b>msgctl </b>operation</i>*/<o:p></o:p></span></p>

<p style="margin-left:36.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">}
;<o:p></o:p></span></p>

<p>Red poruka se nakon uporabe treba obrisati. Npr. pozivom <span style="font-size:11.0pt;mso-bidi-font-size:10.0pt;font-family:&quot;Courier New&quot;">msgctl(msqid,IPC_RMID,NULL)</span><span style="mso-bidi-font-size:10.0pt">. Sustavski poziv</span></p>

<p style="margin-left:36.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int
msgctl(int msqid, int cmd, struct msqid_ds *buf);<o:p></o:p></span></p>

<p>obavlja jednu od tri operacije u ovisnosti o <i>cmd</i>:</p>

<p style="margin-left:36.0pt"><span style="font-family:&quot;Courier New&quot;">IPC_STAT </span>popunjava
strukturu <i>buf</i> vrijednostima za red poruka <i>msqid</i>.</p>

<p style="margin-left:36.0pt"><span style="font-family:&quot;Courier New&quot;">IPC_SET </span>mijenja
<i>msg_perm.uid</i>, <i>msg_perm.gid</i>, <i>msg_perm.mode</i> i <i>msg_qbytes</i>
za red poruka <i>msqid</i> sa vrijednostima iz <i>buf</i>.</p>

<p style="margin-left:36.0pt"><span style="font-family:&quot;Courier New&quot;">IPC_RMID </span>uništava
red poruka <i>msqid</i> i bilo koji zablokirani poziv vraæa grešku u tom
sluèaju.</p>

<p><b>OKOLINA (<i>environment</i>)<o:p></o:p></b></p>

<p>Okolina je niz znakovnih nizova oblika "<i>ime=vrijednost</i>"
koji se predaje svakom programu prilikom pokretanja. <i>ime</i> je varijabla
okoline. Uobièajeno je za imena tih varijabli upotrebljavati velika slova iako
to nije obavezno.</p>

<p>Varijable okoline se najèešæe postavljaju korištenjem korisnièke ljuske
(vidi: <span style="font-family:&quot;Courier New&quot;">man sh</span>, <span style="font-family:&quot;Courier New&quot;">man csh</span>). U ljusci <i>sh</i> se sa:</p>

<p align="center" style="text-align:center"><span style="font-family:&quot;Courier New&quot;">ime=vrijednost<o:p></o:p></span></p>

<p>postavlja varijabla za samo ljusku. Tek ako se izvede:</p>

<p align="center" style="text-align:center"><span style="font-family:&quot;Courier New&quot;">export
ime<o:p></o:p></span></p>

<p>ista varijabla se ukljuèuje i u okolinu koju ljuska predaje programima koje
poziva. <span style="font-family:&quot;Courier New&quot;">export</span> daje popis svih
varijabli koje se predaju kao okolina programima, dok <span style="font-family:
&quot;Courier New&quot;">set</span> daje popis svih varijabli koje poznaje sama ljuska. <span style="font-family:&quot;Courier New&quot;">unset ime</span> poništava definiciju
varijable <i>ime</i>.</p>

<p>U ljusci <i>csh</i> se varijabla okoline programa definira sa:</p>

<p align="center" style="text-align:center"><span style="font-family:&quot;Courier New&quot;">setenv
ime vrijednost<o:p></o:p></span></p>

<p>Varijable same ljuske se postavljaju sa:</p>

<p align="center" style="text-align:center"><span style="font-family:&quot;Courier New&quot;">set
ime=vrijednost<o:p></o:p></span></p>

<p>Neke od najèešæe korištenih varijabli: <i>logname</i>, <i>home</i>, <i>path</i>,
<i>user</i> i <i>term</i> automatski se ukljuèuju i u okolinu nakon ove naredbe,
pa za njih nije potrebno upotrebljavati <i>setenv</i>. Prilikom ukljuèenja u
okolinu, imena ovih varijabli se pišu velikim slovima. <span style="font-family:
&quot;Courier New&quot;">setenv</span> izlistava okolinu koja se predaje programima, dok <span style="font-family:&quot;Courier New&quot;">set</span> daje popis svih varijabli koje
poznaje sama ljuska.</p>

<p><b>Kako se poziva <i>main<o:p></o:p></i></b></p>

<p>Prototip prema kojem se poziva funkcija <i>main</i> svakog programa u UNIX-u
je:</p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int main(int argc,
char *argv[], char *envp[]);<o:p></o:p></span></p>

<p><i>argc</i> je broj argumenata navedenih kod poziva programa, a <i>argv</i>
je niz od <i>argc</i> kazaljki na te argumente kao nizove znakova. Prvi od tih
nizova je ime samog pozvanog programa. <i>envp</i> je niz kazaljki na nizove
znakova oblika "<i>ime=vrijednost</i>" koji èine okolinu. Posljednja
kazaljka je <span style="font-family:&quot;Courier New&quot;">NULL</span>. Okolini se
može pristupiti i na praktièniji naèin nego korištenjem <i>envp</i>. Zbog toga
se <i>main</i> može definirati i kao:</p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int main(int argc,
char *argv[]) { ... }<o:p></o:p></span></p>

<p>Takoðer, program koji ne koristi nikakve ulazne parametre može definirati <i>main</i>
kao:</p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int main(void) {
... }<o:p></o:p></span></p>

<p><i>main</i> treba vratiti cjelobrojnu vrijednost jer poziv možemo
pojednostavljeno zamisliti kao:</p>

<p align="center" style="text-align:center"><span style="font-size:10.0pt;
font-family:&quot;Courier New&quot;">exit(main(argc, argv, envp));<o:p></o:p></span></p>

<p>Ako program završava pozivom <i>exit</i> na nekom mjestu, onda ne dolazi do
povratka iz <i>main</i>. Meðutim, ako <i>main</i> normalno završava, onda je
potrebna povratna vrijednost koja æe postati argument poziva <i>exit</i>.</p>

<p><b>Pristup varijablama okoline iz programa<o:p></o:p></b></p>

<p><i>envp</i> nije pogodan za pristup varijablama okoline jer je poznat samo
unutar main, a ne i u ostalim funkcijama programa. Zato postoji globalna
varijabla:</p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">extern char
*environ[];<o:p></o:p></span></p>

<p>koja je, takoðer, niz kazaljki na nizove znakova koji èine okolinu. Toj
varijabli se može pristupati izravno ili korištenjem funkcija <i>getenv</i> i <i>putenv</i>.</p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">char *getenv(char
*name);<o:p></o:p></span></p>

<p><i>name</i> pokazuje na niz znakova s <i>imenom</i> varijable okoline kojoj
treba pristupiti. Rezultat je kazaljka na <i>vrijednost</i> te varijable u nizu
oblika "<i>ime=vrijednost</i>" ili <span style="font-family:&quot;Courier New&quot;">NULL</span>
ako varijabla nije naðena. Npr. ako u okolini postoji "<i>nadimak=pero</i>", 
tada æe getenv("<i>nadimak</i>") vratiti pokazivaè na "<i>pero</i>".</p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int putenv(char
*string);<o:p></o:p></span></p>

<p><i>string</i> pokazuje na niz znakova oblika "<i>ime=vrijednost</i>".
<i>putenv</i> ga ukljuèuje u okolinu umjesto postojeæeg niza koji poèinje istim
<i>imenom</i> ili ga dodaje u okolinu. Rezultat je razlièit od 0 samo ako <i>putenv</i>
nije dobio potrebnu memoriju za proširenje okoline.</p>

<p><i>putenv</i> mijenja okolinu na koju pokazuje <i>environ</i> i kojoj se
pristupa pomoæu <i>getenv</i>. Meðutim, pri tome se ne mijenja <i>envp</i> koji
je predan funkciji <i>main</i>. Niz znakova na koji pokazuje kazaljka <i>string</i>
postaje dio okoline.</p>

<p><b>POKRETANJE PROGRAMA (sustavski pozivi <i>exec</i>...)<o:p></o:p></b></p>

<p>Sustavski pozivi <i>exec</i> (u svim oblicima) inicijaliziraju proces novim
programom. Jedino pomoæu njih se izvršavaju programi u UNIX-u. Postoji šest
poziva koji se uglavnom razlikuju po naèinu prijenosa parametara (vidi <span style="font-family:&quot;Courier New&quot;">man exec</span>):</p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int execl(char
*path, char *arg0, char *arg1,....., char *argn, char *null)<o:p></o:p></span></p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int execv(char
*path, char *argv[])<o:p></o:p></span></p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int execle(char
*path, char *arg0,...., char *argn, char *null, char *envp[])<o:p></o:p></span></p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int execve(char
*path, char *argv[], char *envp[])<o:p></o:p></span></p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int execlp(char
*file, char *arg0,...., char *argn, char *null)<o:p></o:p></span></p>

<p><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">int execvp(char
*file, char *argv[])<o:p></o:p></span></p>

<p>Pozivom neke verzije poziva <i>exec</i> izvršava se navedeni program od
poèetka, tj. pozivom funkcije <i>main</i>. Ako je poziv uspio, iz njega nema
povratka. U sluèaju greške rezultat je -1.</p>

<p>Argument <i>path</i> mora sadržavati put do datoteke sa izvršnom verzijom
programa ili tekstom koji se može interpretirati (poèinje sa<span style="font-family:&quot;Courier New&quot;"> #! </span>) nekim drugim programom, najèešæe
ljuskom. Kod <i>execlp</i> i <i>execvp</i>, dovoljno je da argument <i>file</i>
bude samo ime takve datoteke, a ona se traži u direktorijima koji su navedeni
kao vrijednost varijable okoline "<span style="font-family:&quot;Courier New&quot;">PATH</span>".</p>

<p><i>execl</i>, <i>execle</i> i <i>execlp</i> imaju varijabilan broj
argumenata. Prvi argument <i>arg0</i> uvijek mora biti ime izvršne verzije
prorama, a <span style="font-family:&quot;Courier New&quot;">NULL</span> je oznaka kraja
argumenata. Od tih argumenata se kreira <i>argv</i> koji se predaje funkciji <i>main</i>
novog programa.</p>

<p>Kod <i>execv</i>, <i>execve</i> i <i>execvp</i> predaje se izravno <i>argv</i>.
Po dogovoru, i on mora imati barem jednu kazaljku koja pokazuje na niz znakova
s imenom programa. Ostale pokazuju na argumente programa. Posljednja kazaljka
mora biti <span style="font-family:&quot;Courier New&quot;">NULL</span> kako bi se znalo
gdje je kraj i moglo izraèunati <i>argc</i>.</p>

<p><i>envp</i> u <i>execle</i> i <i>execve</i> je niz kazaljki na nizove
znakova koji èine okolinu. Posljednja kazaljka mora biti <span style="font-family:&quot;Courier New&quot;">NULL</span>. Kod ostalih poziva, novi program
dobiva postojeæu okolinu (<i>environ</i>).</p>

<p>Otvoreni opisnici datoteka ostaju otvoreni kroz poziv <i>execl</i>. Ako to
nije potrebno, treba ih zatvoriti prije nekog od ovih poziva. Kao i kod
sustavskog poziva <i>fork</i>, veæina sustavskih atributa ostaje nepromjenjena.</p>

<p><b>Primjer upotrebe <i>exec</i> i <i>fork<o:p></o:p></i></b></p>

<p>Obièno <i>exec</i> služi za inicijalizaciju procesa djeteta kreiranog
sustavskim pozivom <i>fork</i>. Slijedeæi primjer pokazuje kako se<i> fork</i>
i <i>exec</i> obièno pozivaju:</p>

<p style="margin-left:36.0pt"><span style="font-size:10.0pt;font-family:&quot;Courier New&quot;">switch
(fork()) { <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left:72.0pt"><span style="font-size:10.0pt;
font-family:&quot;Courier New&quot;">case -1:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left:108.0pt"><span style="font-size:10.0pt;
font-family:&quot;Courier New&quot;">printf("Ne mogu kreirati novi proces\n");<br>
break;<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left:72.0pt"><span style="font-size:10.0pt;
font-family:&quot;Courier New&quot;">case 0:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left:108.0pt"><span style="font-size:10.0pt;
font-family:&quot;Courier New&quot;">execl("./ime","ime",NULL);<br>
exit(1);<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left:72.0pt"><span style="font-size:10.0pt;
font-family:&quot;Courier New&quot;">default:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left:108.0pt"><span style="font-size:10.0pt;
font-family:&quot;Courier New&quot;">wait(NULL);<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left:36.0pt"><span style="font-size:10.0pt;
font-family:&quot;Courier New&quot;">}<o:p></o:p></span></p>

<p>Ako <i>fork</i> ne uspije, rezultat je -1. Novi proces nije kreiran i dovoljno
je ispisati odgovarajuæu poruku ili pokušati ponovo. Ako je rezultat 0,
nalazimo se u procesu djetetu i inicijaliziramo ga s programom <span style="font-family:&quot;Courier New&quot;">ime</span> bez dodatnih argumenata. Normalno
nema povratka iz <i>execl</i>, ali ako on ne uspije, dijete ipak treba završiti
sa <i>exit</i>. U sluèaju nekog drugog rezultata poziva <i>fork</i>, radi se o
nastavku procesa roditelja koji treba prièekati da dijete završi.</p>

</div>

<hr>
<p><b>UPUTE za rad s naredbama ljuske operacijskog sustava za oslobaðanje
zauzetih raèunalnih resursa (zajednièke memorije, semafora i redova poruka)
ukoliko doðe do nepredvidivog (!?) prekida izvoðenja programa koji ih zauzima:</b></p>
<p><b>Naredba<i> ipcs</i></b></p>
<p>Ova naredba daje informacije o sredstvima koja sudjeluju u komunikaciji meðu
procesima. Bez opcija ispisuje informacije o postojeæim redovima poruka,
zajednièkoj memoriji i skupovima semafora.</p>
<p>Poziva se sa: <span style="font-family:&quot;Courier New&quot;">ipcs [<i>
opcije</i> ]</span>.</p>
<p>Opcije:</p>
<p style="margin-left:72.0pt">-q ispisuje informacije o aktivnim redovima poruka<br>
-m ispisuje informacije o aktivnim segmentima zajednièke memorije<br>
-s ispisuje informacije o aktivnim semaforima</p>
<p>Ako niti jedna od ovih opcija nije specificirana, tada se ispis može
kontrolirati slijedeæim opcijama:</p>
<p style="margin-left:72.0pt">-b ispisuje najveæu dozvoljenu velièinu
informacije (na primjer, najveæi dozvoljeni broj bajtova u redu poruka)<br>
-c ispisuje ime korisnika i njegove grupe<br>
-o ispisuje broj poruka u redu i ukupan broj bajtova u redu poruka, odnosno broj
procesa prikljuèenih zajednièkoj memoriji<br>
-p ispisuje identifikacijski broj procesa ( koji je zadnji poslao poruku,
prikljuèio zajednièku memoriju i slièno)<br>
-t ispisuje informacije o vremenu koje ima nekakve veze sa semaforima, redovima
poruka ili zajednièkom memorijom<br>
-a upotrijebiti sve opcije</p>
<p>Stanje se može promjeniti dok se izvršava ova naredba. pa je slika koju
daje samo približna.</p>
<p><b>Naredba<i> ipcrm</i></b></p>
<p>Ova naredba uklanja red poruka, skup semafora ili oslobaða zajednièku
memoriju. U stvari uklanjaju se identifikacijski brojevi. Poziva se sa: <span style="font-family:&quot;Courier New&quot;">ipcrm
[ <i>opcije</i> ]</span>.</p>
<p>Opcije:</p>
<p style="margin-left:36.0pt">-q<i> msqid </i>uklanja identifikator reda poruka<i>
msqid</i> iz sistema<br>
-m <i>shmid </i>uklanja identifikator zajednièke memorije <i>shmid </i>iz
sistema<br>
-s <i>semid </i>uklanja identifikator semafora <i>semid<br>
</i>-Q <i>msgkey </i>uklanja identifikator reda poruka koji je kreiran s kljuèem
<i>msgkey<br>
</i>-M <i>shmkey </i>uklanja identifikator zajednièke memorije zauzete s kljuèem
<i>shmkey<br>
</i>-S <i>semkey </i>uklanja identifikator semafora kreiranog s kljuèem <i>semkey</i></p>
<hr>

<p>Primjer rada s redovima poruka: <a href="http://www.zemris.fer.hr/predmeti/os2/komunikacija/kirk.c">kirk.c</a> <a href="http://www.zemris.fer.hr/predmeti/os2/komunikacija/spock.c">spock.c</a>
<br>
<font color="#FF0000">Pripazite! U navedenim primjerima kljuè koji se koristi 
prilikom dobavljanja reda poruka je postavljen na 12345. Ukoliko više studenata 
odjednom pokreæe primjer, doæi do greške. Naime, red poruka je veæ stvoren red s 
pravima pristupa 0600 i nitko drugi nema pravo slati ili èitati u taj red 
poruka! Stogo, promijenite kljuè u primjerice identifikator korisnika - UID, 
kojeg možete dobaviti funkcijom getuid().</font></p>




</body></html>